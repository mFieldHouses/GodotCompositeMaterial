static func compose_shader_code(layer_num : int, shaded : bool = true) -> String:
	var compose_sc = func compose_simple_sc(line_base : String, sc_size : int) -> String:
		var result : String
		for i in sc_size:
			var layer_idx = i + 1
			result += "case " + str(layer_idx) + ": " + line_base.replace("%s", str(layer_idx)) + " \n"
				
		return result
	
	var compose_cr = func compose_cr(base : Dictionary, size : int) -> String:
		var result : String = "return "
		for i in size:
			var layer_idx = i + 1
			result += base.string.replace("%s", str(layer_idx))
			if base.is_boolean_operation:
				result += " || "
			else:
				result += " + "
		
		if base.is_boolean_operation:
			result = result.trim_suffix(" || ")
		else:
			result = result.trim_suffix(" + ")
		
		result += ";"
				
		return result
	
	
	var result : String;
	
	if shaded:
		result = render_mode_shaded_string
	else:
		result = render_mode_unshaded_string
	
	result += base_string
	
	var parameters : String
	var fragment_snippets : String
	
	for i in layer_num:
		var layer_idx : int = i + 1
		
		parameters += (parameters_string.replace("%s", str(layer_idx))) + "\n"
		fragment_snippets += (fragment_snippet_string.replace("%s", str(layer_idx))) + "\n"
		
	result = result.replace("%parameters", parameters)
	result = result.replace("%layer_fragment_snippets", fragment_snippets)
	
	for mapping in sc_mappings:
		result = result.replace(mapping, compose_sc.call(sc_mappings[mapping], layer_num))
	
	for mapping in cr_mappings:
		result = result.replace(mapping, compose_cr.call(cr_mappings[mapping], layer_num))
	
	return result
